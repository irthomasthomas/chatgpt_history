## USER
You are an Linux AI programming assistant.

- Follow the user's requirements carefully & to the letter.
- First think step-by-step -- describe your plan for what to build in pseudocode, written out in great detail.
- Then output the code in a single code block.
- Minimize any other prose.
- Avoid using code, or command options that are not already popular.
Ok?

## ASSISTANT
Understood. Please provide the user's requirements for the programming task.

## USER
DJI_0796.MP4
Camera: Zoom
Color: Normal

{
    "streams": [
        {
            "index": 0,
            "codec_name": "hevc",
            "codec_long_name": "H.265 / HEVC (High Efficiency Video Coding)",
            "profile": "Main",
            "codec_type": "video",
            "codec_tag_string": "hvc1",
            "codec_tag": "0x31637668",
            "width": 3840,
            "height": 2160,
            "coded_width": 3840,
            "coded_height": 2160,
            "closed_captions": 0,
            "has_b_frames": 1,
            "pix_fmt": "yuv420p",
            "level": 180,
            "color_range": "tv",
            "color_space": "bt709",
            "color_transfer": "bt709",
            "color_primaries": "bt709",
            "chroma_location": "left",
            "refs": 1,
            "r_frame_rate": "50/1",
            "avg_frame_rate": "50/1",
            "time_base": "1/5000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 51600,
            "duration": "10.320000",
            "bit_rate": "120813189",
            "nb_frames": "516",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0,
                "timed_thumbnails": 0
            },
            "tags": {
                "creation_time": "2023-03-15T15:31:17.000000Z",
                "language": "und",
                "handler_name": "VideoHandler",
                "vendor_id": "[0][0][0][0]"
            }
        }
    ],
    "format": {
        "filename": "/media/thomas/c126dcc9-37b2-4a2c-b0c0-37ff409f39ec/test/DJI_0796.MP4",
        "nb_streams": 4,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "10.320000",
        "size": "160934430",
        "bit_rate": "124755372",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2mp41",
            "creation_time": "2023-03-15T15:31:17.000000Z",
            "encoder": "DJIMavic3"
        }
    }
}

DJI_0795.MP4
Camera: Zoom
Color: Normal

{
    "streams": [
        {
            "index": 0,
            "codec_name": "h264",
            "codec_long_name": "H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10",
            "profile": "High",
            "codec_type": "video",
            "codec_tag_string": "avc1",
            "codec_tag": "0x31637661",
            "width": 3840,
            "height": 2160,
            "coded_width": 3840,
            "coded_height": 2160,
            "closed_captions": 0,
            "has_b_frames": 2,
            "pix_fmt": "yuv420p",
            "level": 51,
            "color_range": "tv",
            "color_space": "bt709",
            "color_transfer": "bt709",
            "color_primaries": "bt709",
            "chroma_location": "left",
            "refs": 1,
            "is_avc": "true",
            "nal_length_size": "4",
            "r_frame_rate": "50/1",
            "avg_frame_rate": "50/1",
            "time_base": "1/5000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 51800,
            "duration": "10.360000",
            "bit_rate": "160909592",
            "bits_per_raw_sample": "8",
            "nb_frames": "518",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0,
                "timed_thumbnails": 0
            },
            "tags": {
                "creation_time": "2023-03-15T15:30:42.000000Z",
                "language": "und",
                "handler_name": "VideoHandler",
                "vendor_id": "[0][0][0][0]"
            }
        }
    ],
    "format": {
        "filename": "/media/thomas/c126dcc9-37b2-4a2c-b0c0-37ff409f39ec/test/DJI_0795.MP4",
        "nb_streams": 4,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "10.360000",
        "size": "213475487",
        "bit_rate": "164845935",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2avc1mp41",
            "creation_time": "2023-03-15T15:30:42.000000Z",
            "encoder": "DJIMavic3"
        }
    }
}

DJI_0794.MP4
Camera: Wide
Colour: HLG

{
    "streams": [
        {
            "index": 0,
            "codec_name": "hevc",
            "codec_long_name": "H.265 / HEVC (High Efficiency Video Coding)",
            "profile": "Main 10",
            "codec_type": "video",
            "codec_tag_string": "hvc1",
            "codec_tag": "0x31637668",
            "width": 5120,
            "height": 2700,
            "coded_width": 5120,
            "coded_height": 2704,
            "closed_captions": 0,
            "has_b_frames": 1,
            "pix_fmt": "yuv420p10le",
            "level": 180,
            "color_range": "tv",
            "color_space": "bt2020nc",
            "color_transfer": "arib-std-b67",
            "color_primaries": "bt2020",
            "chroma_location": "left",
            "refs": 1,
            "r_frame_rate": "30000/1001",
            "avg_frame_rate": "30000/1001",
            "time_base": "1/30000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 358358,
            "duration": "11.945267",
            "bit_rate": "140457424",
            "nb_frames": "358",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0,
                "timed_thumbnails": 0
            },
            "tags": {
                "creation_time": "2023-03-15T15:23:33.000000Z",
                "language": "und",
                "handler_name": "VideoHandler",
                "vendor_id": "[0][0][0][0]"
            }
        }
    ],
    "format": {
        "filename": "/media/thomas/c126dcc9-37b2-4a2c-b0c0-37ff409f39ec/test/DJI_0794.MP4",
        "nb_streams": 4,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "11.946000",
        "size": "213980119",
        "bit_rate": "143298254",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2mp41",
            "creation_time": "2023-03-15T15:23:33.000000Z",
            "encoder": "DJIMavic3"
        }
    }
}

DJI_0793.MP4
Camera: Wide
Colour: Normal

{
    "streams": [
        {
            "index": 0,
            "codec_name": "hevc",
            "codec_long_name": "H.265 / HEVC (High Efficiency Video Coding)",
            "profile": "Main",
            "codec_type": "video",
            "codec_tag_string": "hvc1",
            "codec_tag": "0x31637668",
            "width": 5120,
            "height": 2700,
            "coded_width": 5120,
            "coded_height": 2704,
            "closed_captions": 0,
            "has_b_frames": 1,
            "pix_fmt": "yuv420p",
            "level": 180,
            "color_range": "tv",
            "color_space": "bt709",
            "color_transfer": "bt709",
            "color_primaries": "bt709",
            "chroma_location": "left",
            "refs": 1,
            "r_frame_rate": "30000/1001",
            "avg_frame_rate": "30000/1001",
            "time_base": "1/30000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 397397,
            "duration": "13.246567",
            "bit_rate": "140913617",
            "nb_frames": "397",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0,
                "timed_thumbnails": 0
            },
            "tags": {
                "creation_time": "2023-03-15T15:22:45.000000Z",
                "language": "und",
                "handler_name": "VideoHandler",
                "vendor_id": "[0][0][0][0]"
            }
        }
    ],
    "format": {
        "filename": "/media/thomas/c126dcc9-37b2-4a2c-b0c0-37ff409f39ec/test/DJI_0793.MP4",
        "nb_streams": 4,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "13.248000",
        "size": "238119274",
        "bit_rate": "143791832",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2mp41",
            "creation_time": "2023-03-15T15:22:45.000000Z",
            "encoder": "DJIMavic3"
        }
    }
}

DJI_0792.MP4
Camera: Wide
Colour: D-Log

{
    "streams": [
        {
            "index": 0,
            "codec_name": "hevc",
            "codec_long_name": "H.265 / HEVC (High Efficiency Video Coding)",
            "profile": "Main 10",
            "codec_type": "video",
            "codec_tag_string": "hvc1",
            "codec_tag": "0x31637668",
            "width": 5120,
            "height": 2700,
            "coded_width": 5120,
            "coded_height": 2704,
            "closed_captions": 0,
            "has_b_frames": 1,
            "pix_fmt": "yuv420p10le",
            "level": 180,
            "color_range": "tv",
            "color_space": "bt709",
            "color_transfer": "bt709",
            "color_primaries": "bt709",
            "chroma_location": "left",
            "refs": 1,
            "r_frame_rate": "30000/1001",
            "avg_frame_rate": "30000/1001",
            "time_base": "1/30000",
            "start_pts": 0,
            "start_time": "0.000000",
            "duration_ts": 2329327,
            "duration": "77.644233",
            "bit_rate": "140108678",
            "nb_frames": "2327",
            "disposition": {
                "default": 1,
                "dub": 0,
                "original": 0,
                "comment": 0,
                "lyrics": 0,
                "karaoke": 0,
                "forced": 0,
                "hearing_impaired": 0,
                "visual_impaired": 0,
                "clean_effects": 0,
                "attached_pic": 0,
                "timed_thumbnails": 0
            },
            "tags": {
                "creation_time": "2023-03-15T15:19:24.000000Z",
                "language": "und",
                "handler_name": "VideoHandler",
                "vendor_id": "[0][0][0][0]"
            }
        }
    ],
    "format": {
        "filename": "/media/thomas/c126dcc9-37b2-4a2c-b0c0-37ff409f39ec/test/DJI_0792.MP4",
        "nb_streams": 4,
        "nb_programs": 0,
        "format_name": "mov,mp4,m4a,3gp,3g2,mj2",
        "format_long_name": "QuickTime / MOV",
        "start_time": "0.000000",
        "duration": "77.645000",
        "size": "1381936693",
        "bit_rate": "142385131",
        "probe_score": 100,
        "tags": {
            "major_brand": "isom",
            "minor_version": "512",
            "compatible_brands": "isomiso2mp41",
            "creation_time": "2023-03-15T15:19:24.000000Z",
            "encoder": "DJIMavic3"
        }
    }
}

## ASSISTANT
The information you provided contains details about several video files, recorded with different camera settings and color profiles. Below is a summary for each video file:

1. DJI_0796.MP4:
- Camera: Zoom
- Color: Normal
- Codec: H.265 / HEVC (High Efficiency Video Coding)
- Resolution: 3840x2160
- Frame Rate: 50 fps
- Bit Rate: 120,813,189
- Duration: 10.32 seconds

2. DJI_0795.MP4:
- Camera: Zoom
- Color: Normal
- Codec: H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10
- Resolution: 3840x2160
- Frame Rate: 50 fps
- Bit Rate: 160,909,592
- Duration: 10.36 seconds

3. DJI_0794.MP4:
- Camera: Wide
- Color: HLG (Hybrid Log-Gamma)
- Codec: H.265 / HEVC (High Efficiency Video Coding)
- Resolution: 5120x2700
- Frame Rate: 29.97 fps (30000/1001)
- Bit Rate: 140,457,424
- Duration: 11.95 seconds

4. DJI_0793.MP4:
- Camera: Wide
- Color: Normal
- Codec: H.265 / HEVC (High Efficiency Video Coding)
- Resolution: 5120x2700
- Frame Rate: 29.97 fps (30000/1001)
- Bit Rate: 140,913,617
- Duration: 13.25 seconds

5. DJI_0792.MP4:
- Camera: Wide
- Color: D-Log (Logarithmic encoding for wider dynamic range)
- Codec: H.265 / HEVC (High Efficiency Video Coding)
- Resolution: 5120x2700
- Frame Rate: 29.97 fps (30000/1001)
- Bit Rate: 140,108,678
- Duration: 77.64 seconds

These videos vary in terms of camera settings, color profiles, codecs, resolutions, frame rates, bit rates, and durations.

## USER
Based on the above, write an algorithm and bash script to detect each Camera, Color, Codec, Resolution, and Frame Rate.

## ASSISTANT
To detect the camera properties (Camera, Color, Codec, Resolution, and Frame Rate), you can use a combination of shell commands and tools like `ffmpeg` and `v4l2-ctl`. Here is a bash script to get the desired information:

```bash
#!/bin/bash

# Get the list of connected video devices
devices=$(ls /dev/video*)

# Install necessary tools if not installed
if ! command -v v4l2-ctl &> /dev/null; then
  echo "v4l2-ctl not found. Installing v4l-utils..."
  sudo apt-get update && sudo apt-get install v4l-utils -y
fi

if ! command -v ffmpeg &> /dev/null; then
  echo "ffmpeg not found. Installing ffmpeg..."
  sudo apt-get update && sudo apt-get install ffmpeg -y
fi

# Function to extract the required information using v4l2-ctl and ffmpeg
function get_camera_properties() {
  device=$1

  # Get camera information
  camera_info=$(v4l2-ctl --all -d $device)

  # Extract the camera name
  camera=$(echo "$camera_info" | grep "Card type" | awk -F ': ' '{print $2}')

  # Get color format
  color=$(echo "$camera_info" | grep "pixelformat" | awk -F ': ' '{print $2}' | awk -F ' (' '{print $1}')

  # Get codec
  codec=$(echo "$camera_info" | grep "Codec" | awk -F ': ' '{print $2}')

  # Get resolution and frame rate using ffmpeg
  ffmpeg_output=$(ffmpeg -f v4l2 -i $device -vframes 1 -f null - 2>&1)

  # Extract resolution
  resolution=$(echo "$ffmpeg_output" | grep -oP 'Stream.*Video.* \K\d+x\d+')

  # Extract frame rate
  frame_rate=$(echo "$ffmpeg_output" | grep -oP 'Stream.*Video.* \K\d+ fps')

  echo "Camera: $camera"
  echo "Color: $color"
  echo "Codec: $codec"
  echo "Resolution: $resolution"
  echo "Frame Rate: $frame_rate"
}

# Iterate through the devices and call the function
for device in $devices; do
  echo "Device: $device"
  get_camera_properties $device
  echo "-----------------------"
done
```

To run this script, follow these steps:

1. Save the script in a file named `detect_camera_properties.sh`.
2. Open a terminal and navigate to the directory where the script is saved.
3. Make the script executable by running: `chmod +x detect_camera_properties.sh`.
4. Run the script using: `./detect_camera_properties.sh`.

This script detects the connected cameras and prints their properties. It uses `v4l2-ctl` to get camera, color, and codec information, and `ffmpeg` to get the resolution and frame rate.